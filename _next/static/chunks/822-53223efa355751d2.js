"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{2039:(e,t,n)=>{n.d(t,{ProfileProvider:()=>c,x:()=>s});var o=n(5155),i=n(2115),a=n(5674);let r=(0,i.createContext)(void 0);function c(e){let{children:t}=e,[n,c]=(0,i.useState)(null),[s,l]=(0,i.useState)(!0),[u,p]=(0,i.useState)(!1),[d,m]=(0,i.useState)(null),[g,f]=(0,i.useState)({}),y=function(e,t){let[n,o]=(0,i.useState)(e);return(0,i.useEffect)(()=>{let t=setTimeout(()=>{o(e)},5e3);return()=>{clearTimeout(t)}},[e,5e3]),n}(g,5e3);(0,i.useEffect)(()=>{(async()=>{l(!0);try{let e=null;if(e=sessionStorage.getItem("current_user_id")){let t=await a.L.getUserById(e);t?(c(v(t)),m(e),p(!1)):await _()}else await _()}catch(e){console.error("Error initializing profile:",e),await _()}finally{l(!1)}})()},[]),(0,i.useEffect)(()=>{Object.keys(y).length>0&&d&&(async()=>{try{console.log("Syncing profile updates:",Object.keys(y));let e=await a.L.updateUser(d,y);e?(c(v(e)),console.log("Profile synced successfully")):console.warn("Profile update returned null, keeping local changes"),f({})}catch(e){console.error("Error syncing profile updates:",{error:e,updates:Object.keys(y),userId:d})}})()},[y,d]);let _=async()=>{try{let e=await a.L.createUser({name:"New User",interests:[],preferred_causes:[],contribution_stats:{actions_completed:0,organizations_supported:0,policies_viewed:0,total_impact_score:0},personalization:{layout_preference:"detailed",color_scheme:"neutral",engagement_level:"medium",communication_frequency:"weekly"},profile_completion:20,engagement_metrics:{session_count:1,avg_session_duration:0,page_views:1,actions_per_session:0}});e&&(c(v(e)),m(e.id),p(!0),sessionStorage.setItem("current_user_id",e.id))}catch(e){console.error("Error creating default profile:",e)}},v=e=>({...e,intent_actions:[],preferred_topics:e.preferred_causes,saved_actions:[],policy_engagement_history:[],preferences:{auto_save:!0,notifications:!0,theme:"light",digest_frequency:"weekly"}}),h=(0,i.useCallback)(async e=>{n&&d&&(c(t=>t?{...t,...e,updated_at:new Date().toISOString()}:null),f(t=>({...t,...e})))},[n,d]),S=(0,i.useCallback)(async()=>{if(d)try{l(!0);let e=await a.L.getUserById(d);e&&c(v(e))}catch(e){console.error("Error refreshing profile:",e)}finally{l(!1)}},[d]),w=(0,i.useCallback)(async e=>{try{l(!0);let t=await a.L.createUser(e);t&&(c(v(t)),m(t.id),p(!0),sessionStorage.setItem("current_user_id",t.id))}catch(e){console.error("Error creating new profile:",e)}finally{l(!1)}},[]),b=(0,i.useCallback)(e=>{!n||n.interests.includes(e)||h({interests:[...n.interests,e]})},[n,h]),k=(0,i.useCallback)(e=>{n&&h({interests:n.interests.filter(t=>t!==e)})},[n,h]),C=(0,i.useCallback)(e=>{!n||n.saved_actions.includes(e)||h({saved_actions:[...n.saved_actions,e]})},[n,h]),A=(0,i.useCallback)(e=>{n&&h({saved_actions:n.saved_actions.filter(t=>t!==e)})},[n,h]),E=(0,i.useCallback)((e,t)=>{if(!n)return;let o={policy_id:e,action:t,timestamp:new Date().toISOString()};h({policy_engagement_history:[...n.policy_engagement_history,o],contribution_stats:{...n.contribution_stats,policies_viewed:n.contribution_stats.policies_viewed+1}})},[n,h]),I=(0,i.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;n&&h({contribution_stats:{...n.contribution_stats,[e]:n.contribution_stats[e]+t}})},[n,h]),D=(0,i.useCallback)(async()=>{try{sessionStorage.removeItem("current_user_id"),await _()}catch(e){console.error("Error resetting profile:",e)}},[]),z=(0,i.useCallback)(()=>n?JSON.stringify(n,null,2):"{}",[n]),O=(0,i.useCallback)(e=>{try{var t,n,o,i,a,r,c,s;let l=JSON.parse(e);if(!l.name)return console.error("Invalid profile data: missing name"),!1;let u={name:l.name,email:l.email,location:l.location,interests:Array.isArray(l.interests)?l.interests:[],preferred_causes:Array.isArray(l.preferred_causes)?l.preferred_causes:[],contribution_stats:{actions_completed:(null==(t=l.contribution_stats)?void 0:t.actions_completed)||0,organizations_supported:(null==(n=l.contribution_stats)?void 0:n.organizations_supported)||0,policies_viewed:(null==(o=l.contribution_stats)?void 0:o.policies_viewed)||0,total_impact_score:(null==(i=l.contribution_stats)?void 0:i.total_impact_score)||0},personalization:{layout_preference:(null==(a=l.personalization)?void 0:a.layout_preference)||"detailed",color_scheme:(null==(r=l.personalization)?void 0:r.color_scheme)||"neutral",engagement_level:(null==(c=l.personalization)?void 0:c.engagement_level)||"medium",communication_frequency:(null==(s=l.personalization)?void 0:s.communication_frequency)||"weekly"}};return h(u),!0}catch(e){return console.error("Error importing profile data:",e),!1}},[h]);return(0,o.jsx)(r.Provider,{value:{profile:n,isLoading:s,isNewUser:u,updateProfile:h,addInterest:b,removeInterest:k,addSavedAction:C,removeSavedAction:A,trackPolicyEngagement:E,updateContributionStats:I,resetProfile:D,exportProfileData:z,importProfileData:O,refreshProfile:S,createNewProfile:w},children:t})}function s(){let e=(0,i.useContext)(r);if(void 0===e)throw Error("useProfile must be used within a ProfileProvider");return e}},7083:(e,t,n)=>{n.d(t,{ActionEngagementProvider:()=>s,f:()=>l});var o=n(5155),i=n(2115),a=n(4692);let r=(0,i.createContext)(void 0),c={"be heard":(e,t)=>({ctaType:"contact_rep",templates:[{title:"Contact Your Representatives About ".concat(e),description:"Make your voice heard on ".concat(e," policy by contacting your local representatives. Your input can directly influence legislative decisions."),template:{type:"letter",content:"Dear [Representative Name],\n\nAs your constituent in ".concat(t,", I am writing to express my concerns about ").concat(e,". I urge you to consider the following actions:\n\n[Specific policy recommendations]\n\nThank you for your attention to this critical issue.\n\nSincerely,\n[Your Name]")}},{title:"Submit Public Comment on ".concat(e),description:"Participate in the democratic process by submitting comments on pending ".concat(e," regulations and policies."),template:{type:"form",content:"Structured public comment form for ".concat(e," policy initiatives")}}]}),volunteer:(e,t)=>({ctaType:"volunteer",templates:[{title:"Volunteer for ".concat(e," Organizations in ").concat(t),description:"Find meaningful volunteer opportunities with local organizations working on ".concat(e," in your area."),eventDetails:{date:"Ongoing",time:"Flexible",venue:"Various locations in ".concat(t),rsvpRequired:!0}},{title:"Community Science Projects: ".concat(e),description:"Join citizen science initiatives that gather data and research on ".concat(e," issues affecting your community."),eventDetails:{date:"Weekly",time:"Weekends",venue:"Field locations in ".concat(t),rsvpRequired:!0}}]}),"get help":(e,t)=>({ctaType:"get_help",templates:[{title:"".concat(e," Support Resources in ").concat(t),description:"Access immediate and ongoing support resources for ".concat(e,"-related challenges in your area."),resourceLinks:[{title:"Emergency Assistance",url:"#",type:"emergency"},{title:"Local Support Centers",url:"#",type:"support"},{title:"Application Portal",url:"#",type:"application"}]},{title:"Connect with ".concat(e," Support Network"),description:"Join a community of people addressing similar ".concat(e," challenges and share resources."),template:{type:"form",content:"Intake form to connect with appropriate ".concat(e," support services")}}]}),donate:(e,t)=>({ctaType:"donate",templates:[{title:"Support ".concat(e," Organizations in ").concat(t),description:"Direct financial support to vetted organizations working on ".concat(e," issues in your community."),link:"#donate-local"},{title:"Emergency ".concat(e," Relief Fund"),description:"Contribute to rapid-response funding for urgent ".concat(e," situations affecting ").concat(t,"."),link:"#emergency-fund"}]}),organize:(e,t)=>({ctaType:"organize",templates:[{title:"Start a ".concat(e," Action Group in ").concat(t),description:"Build grassroots power by organizing community members around ".concat(e," issues."),nextSteps:["Identify key stakeholders and allies","Research local ${topic} policy landscape","Plan initial community meeting","Develop action plan and timeline"]},{title:"Join Existing ".concat(e," Coalition"),description:"Connect with established groups working on ".concat(e," to amplify collective impact."),template:{type:"form",content:"Coalition membership application for ".concat(e," advocacy groups")},nextSteps:["Attend coalition meetings","Participate in planned actions","Recruit additional members","Share resources and expertise"]}]})};function s(e){let{children:t}=e,[n,s]=(0,i.useState)(null),[l,p]=(0,i.useState)([]),[d,m]=(0,i.useState)(!1),[g,f]=(0,a.Mj)("user-engagement",{totalActionsViewed:0,actionsCompleted:0,actionsSaved:0,totalTimeSpent:0,preferredIntents:[],preferredTopics:[],preferredLocations:[],engagementPattern:{mostActiveHours:[],preferredActionTypes:[],averageTimePerAction:0},lastEngagement:new Date().toISOString(),streakDays:0}),y=e=>[{id:"default-".concat(e.intent,"-").concat(Date.now()),title:"Take Action on ".concat(e.topic),description:"Get involved with ".concat(e.topic," initiatives in ").concat(e.location,". Explore opportunities to make a meaningful impact."),tags:[e.topic,e.location,e.intent],intent:e.intent,topic:e.topic,location:e.location,cta:"Learn More",ctaType:"learn_more",impact:3,urgency:3,timeCommitment:"1-2 hours",organizationName:"Local Community Groups",generatedAt:new Date().toISOString(),nextSteps:["Research local organizations","Connect with community leaders","Attend community meetings"]}],_=(0,i.useCallback)(async e=>{m(!0),console.log("\uD83C\uDFAF Generating actions for:",e);try{await new Promise(e=>setTimeout(e,1500));let t=e.intent.replace(/_/g," ");console.log("\uD83D\uDD04 Normalized intent:",t);let n=c[t];if(!n){console.warn("No generator found for intent: ".concat(e.intent,", falling back to default"));let t=y(e);return p(t),f(e=>({...e,totalActionsViewed:e.totalActionsViewed+t.length,lastEngagement:new Date().toISOString()})),t}console.log("✅ Generator found, generating actions...");let{ctaType:o,templates:i}=n(e.topic,e.location),a=i.map((t,n)=>({id:"".concat(e.intent,"-").concat(e.topic,"-").concat(Date.now(),"-").concat(n),title:t.title,description:t.description,tags:[e.topic,e.location,e.intent],intent:e.intent,topic:e.topic,location:e.location,cta:({contact_rep:"Contact Representative",volunteer:"Volunteer Now",donate:"Donate Now",petition:"Sign Petition",learn_more:"Learn More",organize:"Start Organizing",get_help:"Get Support"})[o],ctaType:o,impact:Math.floor(3*Math.random())+3,urgency:Math.floor(3*Math.random())+2,timeCommitment:({contact_rep:"5-10 minutes",volunteer:"2-4 hours",donate:"2 minutes",petition:"1 minute",learn_more:"10-20 minutes",organize:"Ongoing",get_help:"As needed"})[o],organizationName:"".concat(e.topic," Action Network"),template:t.template,eventDetails:t.eventDetails,resourceLinks:t.resourceLinks,socialShareData:{title:t.title,message:"Take action on ".concat(e.topic," in ").concat(e.location,"!"),hashtags:["#".concat(e.topic.replace(/\s+/g,"")),"#CivicAction","#ScienceForAction"]},nextSteps:t.nextSteps||["Research current ".concat(e.topic," policies"),"Connect with local advocates","Plan follow-up actions"],generatedAt:new Date().toISOString(),link:t.link}));console.log("\uD83D\uDCCA Generated ".concat(a.length," base actions"));let r=await u(a,g);return console.log("✨ Personalized to ".concat(r.length," actions")),p(r),f(e=>({...e,totalActionsViewed:e.totalActionsViewed+r.length,lastEngagement:new Date().toISOString()})),r}catch(n){console.error("❌ Error generating actions:",n);let t=y(e);return p(t),f(e=>({...e,totalActionsViewed:e.totalActionsViewed+t.length,lastEngagement:new Date().toISOString()})),t}finally{m(!1)}},[g,f]),v=(0,i.useCallback)((e,t)=>{p(t=>t.map(t=>t.id===e?{...t,completedAt:new Date().toISOString()}:t)),f(e=>({...e,actionsCompleted:e.actionsCompleted+1,lastEngagement:new Date().toISOString()}))},[f]),h=(0,i.useCallback)(e=>{p(t=>t.map(t=>t.id===e?{...t,savedAt:new Date().toISOString()}:t)),f(e=>({...e,actionsSaved:e.actionsSaved+1,lastEngagement:new Date().toISOString()}))},[f]),S=(0,i.useCallback)((e,t,n)=>{f(e=>({...e,totalTimeSpent:e.totalTimeSpent+t,lastEngagement:new Date().toISOString()}))},[f]),w=(0,i.useCallback)(()=>l.slice(0,3),[l]),b=(0,i.useCallback)((e,t,n)=>{let o=l.find(t=>t.id===e);o&&f(e=>{let n={...e};return t>=4&&(n.preferredIntents.includes(o.intent)||n.preferredIntents.push(o.intent),n.preferredTopics.includes(o.topic)||n.preferredTopics.push(o.topic),n.preferredLocations.includes(o.location)||n.preferredLocations.push(o.location)),n})},[l,f]),k=(0,i.useCallback)(async e=>{var t;return t=await _(e),t},[_,g]),C=(0,i.useCallback)(()=>{s(null),p([]),m(!1)},[]),A=(0,i.useCallback)(()=>JSON.stringify(g,null,2),[g]);return(0,o.jsx)(r.Provider,{value:{currentIntent:n,generatedActions:l,isGenerating:d,engagementData:g,setCurrentIntent:s,generateAdaptiveActions:_,completeAction:v,saveAction:h,trackEngagement:S,getPersonalizedRecommendations:w,updateUserPreferences:b,getOptimizedResults:k,resetSession:C,exportEngagementData:A},children:t})}function l(){let e=(0,i.useContext)(r);if(void 0===e)throw Error("useActionEngagement must be used within an ActionEngagementProvider");return e}async function u(e,t){return e.map(e=>{var n,o;let i;return{...e,engagementScore:(n=e,o=t,i=20*n.impact,o.preferredIntents.includes(n.intent)&&(i+=15),o.preferredTopics.includes(n.topic)&&(i+=15),o.preferredLocations.includes(n.location)&&(i+=10),Math.min(i+=5*n.urgency,100))}}).sort((e,t)=>(t.engagementScore||0)-(e.engagementScore||0))}}}]);